import '../sass/index.scss'

import { render } from 'react-dom'
import routes     from './router'

import { setServerUrl, api, get, send, setStore, getStore, removeStore } from '@boluome/common-lib'

setServerUrl(/192.168.|localhost/.test(location.hostname)
                ? 'https://dev-api.otosaas.com'
                : `${location.origin}/api`)

setStore('customerUserId', 'blm_test')

new BMap.Geolocation()
  .getCurrentPosition((reply) => {
    const { lat, lng } = reply.point
    const point = { latitude: lat, longitude: lng }
    setStore('geopoint', point)
    const BPoint = new BMap.Point(point.longitude, point.latitude)
    const BCoder = new BMap.Geocoder()
    BCoder.getLocation(BPoint, ({ address, addressComponents }) => {
      setStore('currentAddress' , address)
      setStore('currentPosition', addressComponents)
    })
  })


render(routes, document.getElementById('root'))
